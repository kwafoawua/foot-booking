

<ng-container *ngIf="!esSinAsignar else shuffleIt">
  <div [ngStyle]="{width: '1200px', display: 'flex'}">
    <div *ngFor="let pdl of phaseDateList, let i = index" class="header-fases">

      <div class="header-info">
        <p>{{pdl.name}}</p>
        <p *ngIf="!pdl.state">{{(pdl.date | date:'shortDate') || 'Elegir fecha'}}</p>
        <mat-form-field appearance="standard" *ngIf="pdl.state">
          <input matInput [max]="maxDate" [min]="minDate" [(ngModel)]="pdl.date" [matDatepicker]="datePicker">
          <mat-datepicker-toggle matSuffix [for]="datePicker"></mat-datepicker-toggle>
          <mat-datepicker #datePicker></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="header-button-icon">
        <button *ngIf="!pdl.state" mat-icon-button color="accent" (click)="updatePhaseDate(pdl, 'edit', i)">
          <mat-icon>edit</mat-icon>
        </button>
        <button *ngIf="pdl.state" mat-icon-button color="accent" (click)="updatePhaseDate(pdl, 'update', i)">
          <mat-icon>done</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <div class="row mt-2" *ngIf="tournamentState === 'Completo'">
    <div class="col-12 col-md-8">
      <div class="alert alert-info alert-dismissible fade show" role="alert">
        <span [ngStyle]="{fontSize: '12px'}">
          Te informamos que para iniciar el campeonato necesitas cargar las fechas de las fases y los 8 primeros horarios.
        </span>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
    </div>
    <div class="col-md-1"></div>
    <div class="col-12 col-md-2">
      <button
        mat-flat-button
        color="primary"
        (click)="setCampeonatoState('Iniciado')"
        [disabled]="!sePuedeIniciarCampeonato"
      >
        Iniciar Campeonato
      </button>
    </div>
  </div>

  <div class="row mt-2" *ngIf="tournamentState === 'Iniciado'">
    <div class="col-md-9"></div>
    <div class="col-md-2">
      <button
        mat-flat-button
        color="primary"
        (click)="setCampeonatoState('Finalizado')"
        [disabled]="!sePuedeFinalizarCampeonato"
      >
        Finalizar Campeonato
      </button>
    </div>
  </div>


  <ngtt-single-elimination-tree
    [tournament]="myTournamentData"
    [matchTemplate]="myMatchTemplate">
  </ngtt-single-elimination-tree>
</ng-container>


  <ng-template #myMatchTemplate let-match>
    <app-match
      [teams]="inscriptions"
      [match]="match"
      [isCampeonato]="true"
      (updateMatch)="updateMatch($event)"
    ></app-match>
  </ng-template>


<ng-template #shuffleIt>
  <p>
    Las fases se crean con los equipos de Octavos de final aleatoreamente creados. Para comenzar a diagramar
    las fases presione la opcion de Generar fase aleatoria.
  </p>
  <button mat-button (click)="shuffleMatches()" [disabled]="!isGenerable">Generar Fases</button>
  <span *ngIf="!isGenerable">Se necesitan 16 equipos inscriptos</span>
</ng-template>
